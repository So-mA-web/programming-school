<!DOCTYPE html>
<html lang="ja" style="scroll-behavior: smooth;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中学生が教えるプログラミング教室</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            /* 背景色はそのまま、目に優しいオフホワイト */
            background-color: #f7f9fc;
            scroll-behavior: smooth;
        }
        
        /* ★★★ パステルカラーグラデーションに更新 (Lavender to Mint) ★★★ */
        .text-gradient {
            background-image: linear-gradient(45deg, #A5B4FC, #83E8D0); /* Soft Lavender to Soft Mint */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .fade-in {
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ハンバーガーメニューのスライドアニメーション */
        #mobile-menu {
            transition: transform 0.3s ease-in-out;
            transform: translateY(-100%);
        }
        #mobile-menu.menu-open {
            transform: translateY(0);
        }

        /* ヘッダーリンクのハイライトアニメーション */
        .nav-link-underline {
            position: relative;
            display: inline-block;
            transition: color 0.3s ease;
        }

        .nav-link-underline::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            /* ★★★ パステルカラーに更新 (Soft Mint) ★★★ */
            background-color: #83E8D0; 
            transition: width 0.3s ease;
        }

        .nav-link-underline:hover {
            color: #4a5568; /* hover時の文字色を灰色に */
        }

        .nav-link-underline:hover::after {
            width: 100%;
        }

        /* メッセージボックスのスタイル */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 9999px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .message-box.show {
            opacity: 1;
            visibility: visible;
        }

        /* ヘッダーの高さ分、スクロール位置を調整するCSS */
        html {
            /* ヘッダーの高さが少し増えたため、6rem(96px)程度に調整 */
            scroll-padding-top: 6.5rem; 
        }
        
        /* ヒーローセクションの背景画像スタイル */
        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url(shooting.JPG); /* 汎用的な画像URLを使用 */
            background-size: cover;
            background-position: center;
            z-index: 1;
        }
        
        /* Scratch埋め込みのレスポンシブコンテナ */
        .scratch-embed-container {
            position: relative;
            width: 100%;
            padding-bottom: 75%; /* 4:3のアスペクト比 (480 / 640 = 0.75) */
            height: 0;
            overflow: hidden;
        }
        .scratch-embed-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        /* ★★★ ページ遷移風 詳細ビューのカスタムスタイル ★★★ */
        #activity-detail-view {
            /* 画面全体に固定し、新しいページのように見せる */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 500;
            background-color: #f7f9fc; /* メインページと同じ背景色 */
            overflow-y: auto; /* 詳細コンテンツが長い場合にスクロール可能にする */
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);

            /* スライドイン/アウトのアニメーション設定 */
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* スムーズなアニメーション */
        }

        /* 初期状態: 右側に完全に隠れている (Tailwindのtranslate-x-fullを使用) */
        .slide-hidden {
            transform: translateX(100%);
        }

        /* 表示状態: 画面内にスライドイン */
        .slide-visible {
            transform: translateX(0);
        }

        /* 詳細コンテンツの内部コンテナの最大幅設定 */
        .detail-content-wrapper {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }
        
        /* 詳細本文内のHTML要素のスタイル調整 */
        .article-content strong {
            font-weight: 700; /* 強調を太字に */
            /* ★★★ パステルカラーに更新 (Soft Mint) ★★★ */
            color: #83E8D0;
        }
        .article-content black {
            font-weight: 700; /* 強調を太字に */
            /* ★★★ パステルカラーに更新 (Soft Mint) ★★★ */
            background-color: #000000;
            color: #ffffff;
        }
        .article-content ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            padding-left: 0.5rem;
        }
        /* ★追加: float解除用クラス (h3タグなどで使用) */
        .clear-right {
            clear: right;
        }
        /* ★★★ チラシ拡大モーダルのスタイル ★★★ */
        .flyer-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85); /* 濃い半透明の黒 */
            z-index: 1000; 
            display: none; /* 初期状態では非表示 */
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .flyer-modal-overlay.open {
            display: flex;
            opacity: 1;
        }

        .flyer-modal-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
        }

        .flyer-modal-content img {
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 96vh; /* 画面の高さに合わせる */
            object-fit: contain;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            cursor: pointer; /* 閉じるためのクリック可能を示す */
        }

        /* ★★★ トップに戻るボタンのスタイル (追加) ★★★ */
        #to-top-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 999;
            /* パステルカラーの背景 */
            background-color: #A5B4FC; /* Soft Lavender */
            color: white;
            padding: 1rem;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
            /* アイコンを大きく見せる */
            font-size: 1.5rem; 
            cursor: pointer;
        }

        #to-top-button.show {
            opacity: 1;
            visibility: visible;
            /* ホバーエフェクト */
            transform: scale(1.05);
            background-color: #83E8D0; /* Hover to Soft Mint */
        }
        
        /* ★★★ 声のカード用カスタムスタイル (追加) ★★★ */
        .voice-card {
            border-left: 8px solid #A5B4FC; /* Soft Lavenderのライン */
            position: relative;
            padding: 1.5rem;
        }

        .voice-card::before {
            content: "\f10d"; /* FontAwesomeの引用符アイコン */
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            font-size: 3rem;
            color: #A5B4FC; /* Soft Lavender */
            opacity: 0.2;
            z-index: 1;
        }

        .voice-card-content {
            position: relative;
            z-index: 2;
        }
        
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Header Section (メインナビゲーション) -->
    <!-- flex items-center: タイトルとナビゲーション全体を中央に配置 -->
    <header class="bg-white shadow-md fixed top-0 left-0 w-full z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            
            <!-- タイトル (左側) -->
            <a href="#" class="text-xl sm:text-2xl md:text-3xl font-bold text-gray-900 shrink-0">中学生が教えるプログラミング教室</a>
            
            <!-- ナビゲーションコンテナ (右側) -->
            <!-- md:w-auto: デスクトップで幅をコンテンツに合わせる -->
            <div class="hidden md:block md:w-auto ml-8">
                <nav id="desktop-nav">
                    <!-- Nav リンクリスト -->
                    <!-- flex flex-col: 項目全体を縦並びにする -->
                    <!-- space-y-1: 縦方向のスペース -->
                    <div class="flex flex-col space-y-1">
                        
                        <!-- 1段目 (上段) -->
                        <div class="flex flex-wrap justify-end space-x-6">
                            <a href="#about" class="text-gray-600 hover:text-gray-400 nav-link-underline transition-colors duration-300">概要</a>
                            <a href="#workshop" class="text-gray-600 hover:text-gray-400 nav-link-underline transition-colors duration-300">キミのやりたいことを見つけよう</a>
                            <a href="#teachers" class="text-gray-600 hover:text-gray-400 nav-link-underline transition-colors duration-300">中学生教師</a>
                        </div>
                        
                        <!-- 2段目 (下段) -->
                        <div class="flex flex-wrap justify-end space-x-6">
                            <a href="#gallery" class="text-gray-600 hover:text-gray-400 nav-link-underline transition-colors duration-300">作品例を見てみよう</a>
                            <a href="#voice" class="text-gray-600 hover:text-gray-400 nav-link-underline transition-colors duration-300">参加者の声</a>
                            <a href="#news" class="text-gray-600 hover:text-gray-400 nav-link-underline transition-colors duration-300">活動記録</a>
                        </div>
                    </div>
                </nav>
            </div>
            
            <!-- ハンバーガーメニュー (モバイル用) -->
            <div class="md:hidden">
                <button id="menu-button" class="text-gray-600 focus:outline-none relative">
                    <i id="bars-icon" class="fas fa-bars text-2xl transition-transform duration-300"></i>
                    <i id="times-icon" class="fas fa-times text-2xl transition-transform duration-300 hidden"></i>
                </button>
            </div>
        </div>

        <!-- モバイルメニュー (元のまま) -->
        <div id="mobile-menu" class="fixed top-0 left-0 w-full h-full bg-white z-40 transform -translate-y-full transition-transform duration-300 ease-in-out pt-16">
            <div class="flex flex-col items-center py-8">
                <!-- リンクの順番を更新: About -> Workshop -> Teachers -> Gallery -> Voice -> News -->
                <a href="#about" class="block px-6 py-4 text-gray-800 text-2xl font-bold hover:bg-gray-100 transition duration-300 w-full text-center">概要</a>
                <a href="#workshop" class="block px-6 py-4 text-gray-800 text-2xl font-bold hover:bg-gray-100 transition duration-300 w-full text-center">キミのやりたいことを見つけよう</a>
                <a href="#teachers" class="block px-6 py-4 text-gray-800 text-2xl font-bold hover:bg-gray-100 transition duration-300 w-full text-center">中学生教師</a>
                <a href="#gallery" class="block px-6 py-4 text-gray-800 text-2xl font-bold hover:bg-gray-100 transition duration-300 w-full text-center">作品例を見てみよう</a>
                <!-- ★★★ 生徒の声リンクの追加 ★★★ -->
                <a href="#voice" class="block px-6 py-4 text-gray-800 text-2xl font-bold hover:bg-gray-100 transition duration-300 w-full text-center">参加者の声</a>
                <!-- ★活動記録リンクの維持★ -->
                <a href="#news" class="block px-6 py-4 text-gray-800 text-2xl font-bold hover:bg-gray-100 transition duration-300 w-full text-center">活動記録</a>
            </div>
        </div>
    </header>

    <!-- ヘッダーの高さが変わったため、pt-16を修正する代わりに、CSSのscroll-padding-topで対応しています -->
    <!-- pt-28: ヘッダーの新しい高さに合わせて調整 (約6.5rem = 104px) -->
    <main class="pt-28">
        <!-- Hero Section - 静的な背景画像に変更 -->
        <section id="hero-section" class="relative min-h-screen px-6 flex flex-col items-center justify-center text-center text-gray-800">
            <!-- 背景画像用レイヤー -->
            <div class="hero-background"></div>

            <!-- ヒーローセクションのテキスト部分 -->
            <div class="relative container mx-auto z-20 text-white p-6 rounded-xl bg-black bg-opacity-30">
                <h1 class="text-4xl md:text-5xl lg:text-7xl font-extrabold leading-tight mb-4 fade-in">
                    <span class="text-gradient">中学生が教える</span><br class="md:hidden">プログラミング教室
                </h1>
                <p class="text-xl md:text-2xl mt-6 max-w-2xl mx-auto fade-in" style="animation-delay: 0.2s;">
                    やりたいことがきっと見つかる！<br>Micro:bit、Scratch、Web開発など、何に挑戦するかはキミ次第！
                </p>
            </div>
        </section>

        <!-- About Section (2. 概要) -->
        <section id="about" class="py-20 px-6">
            <div class="container mx-auto">
                <h2 class="text-4xl font-bold text-center text-gray-900 mb-12 fade-in">概要</h2>
                <div class="md:flex md:space-x-12 items-center">
                    <div class="md:w-1/2 mb-8 md:mb-0 fade-in">
                        <img src="program.png" alt="教室の様子" class="rounded-xl shadow-lg w-full h-auto">
                    </div>
                    <div class="md:w-1/2 fade-in">
                        <p class="text-lg text-gray-700 mb-4">
                            このプログラミング教室は、「やりたいこと」を自由に深める教室です。決まったコースやカリキュラムはありません。あなたが興味を持ったツールや言語を、中学生講師がサポートします。
                        </p>
                        <!-- text-gradientはそのままパステルグラデーションを使用 -->
                        <p class="text-lg text-gray-700 mb-4 font-bold text-gradient">
                            小中学生の「プログラミングって何だろう？」という初心者から、<br>「特定の作品を作りたい！」という経験者まで歓迎します。
                        </p>
                        <ul class="space-y-4 text-gray-600">
                            <!-- ★★★ パステルカラーアイコンに更新 (Soft Mint) ★★★ -->
                            <li class="flex items-center"><i class="fas fa-check-circle text-[#83E8D0] mr-2"></i> 中学生講師がサポート</li>
                            <li class="flex items-center"><i class="fas fa-check-circle text-[#83E8D0] mr-2"></i> 事前の知識は一切不要！</li>
                            <li class="flex items-center"><i class="fas fa-check-circle text-[#83E8D0] mr-2"></i> 必要な道具（PC・Micro:bitなど）はすべてこちらで用意可能<br>持ち込みも大歓迎</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Workshop Content Section (3. 内容) -->
        <section id="workshop" class="py-20 px-6 bg-gray-50">
            <div class="container mx-auto">
                <h2 class="text-4xl font-bold text-center text-gray-900 mb-12 fade-in">キミのやりたいことを見つけよう</h2>
                <div class="text-center text-xl text-gray-700 mb-10 max-w-3xl mx-auto fade-in">
                    当日は以下のツールや言語から、あなたが興味のあるものを自由に選んで<br>制作に取り組みます。<br>何を選べばいいか分からなくても、講師が相談に乗りますので<br>ご安心ください！
                </div>
                <div class="grid md:grid-cols-4 gap-6 max-w-5xl mx-auto">
                    <!-- Option 1: Micro:bit -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center card-hover transition duration-300 fade-in">
                        <!-- ★★★ パステルカラーアイコンに更新 (Soft Mint) ★★★ -->
                        <i class="fas fa-microchip text-5xl text-[#83E8D0] mb-3"></i>
                        <h3 class="text-xl font-bold text-gray-900 mb-1">Micro:bit</h3>
                        <p class="text-sm text-gray-600">センサーやLEDを使った<br>電子工作</p>
                    </div>
                    <!-- Option 2: Scratch -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center card-hover transition duration-300 fade-in" style="animation-delay: 0.1s;">
                        <!-- ★★★ パステルカラーアイコンに更新 (Soft Mint) ★★★ -->
                        <i class="fas fa-cubes text-5xl text-[#83E8D0] mb-3"></i>
                        <h3 class="text-xl font-bold text-gray-900 mb-1">Scratch</h3>
                        <p class="text-sm text-gray-600">ブロックを繋いで<br>ゲームやアニメ制作</p>
                    </div>
                    <!-- Option 3: HTML/CSS -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center card-hover transition duration-300 fade-in" style="animation-delay: 0.2s;">
                        <!-- ★★★ パステルカラーアイコンに更新 (Soft Mint) ★★★ -->
                        <i class="fas fa-file-code text-5xl text-[#83E8D0] mb-3"></i>
                        <h3 class="text-xl font-bold text-gray-900 mb-1">Web開発</h3>
                        <p class="text-sm text-gray-600">HTML/CSSでオリジナル<br>Webサイト作成</p>
                    </div>
                    <!-- Option 4: Free Choice -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center card-hover transition duration-300 fade-in" style="animation-delay: 0.3s;">
                        <!-- ★★★ パステルカラーアイコンに更新 (Soft Mint) ★★★ -->
                        <i class="fas fa-brain text-5xl text-[#83E8D0] mb-3"></i>
                        <h3 class="text-xl font-bold text-gray-900 mb-1">その他</h3>
                        <p class="text-sm text-gray-600">Pythonの基礎など<br>相談に応じます！</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Teacher Section (4. 講師) -->
        <section id="teachers" class="py-20 px-6">
            <div class="container mx-auto">
                <h2 class="text-4xl font-bold text-center text-gray-900 mb-12 fade-in">中学生教師</h2>
                <div class="max-w-4xl mx-auto flex flex-col md:flex-row justify-between items-center md:items-start space-y-6 md:space-y-0 p-8 bg-white rounded-xl shadow-lg">
                    <div class="flex flex-col items-center md:items-start md:w-1/2 space-y-4 pr-0 md:pr-8 border-b md:border-b-0 md:border-r border-gray-200 pb-6 md:pb-0">
                        <img src="icon.png" alt="So-㎃" class="w-36 h-36 rounded-full object-cover shrink-0">
                        <div class="text-center md:text-left">
                            <h3 class="text-3xl font-bold text-gray-900 mb-1">So-㎃（そーま）</h3>
                            <!-- ★★★ パステルカラーに更新 (Soft Mint) ★★★ -->
                            <p class="text-lg text-[#83E8D0] mb-4">中学生講師</p>
                            <p class="text-gray-600">
                                SO-MA（そーま）。中学３年生。プログラミングが好きで、独学で学ぶ。小学５年生のときに担任の先生に勧められ初めて応募した大会で、奨励賞を受賞したことから、いろんなコンテストに応募するようになった。人と話すことは得意ではないが、教えるのは好き。<br>好きなもの：オンゲキ・東方プロジェクト・藍染・ピアノ。
                            </p>
                        </div>
                    </div>
                    <div class="md:w-1/2 md:pl-8 text-center md:text-left">
                        <h4 class="text-xl font-bold text-gray-800 mb-4">受賞履歴</h4>
                        <ul class="list-disc list-inside space-y-2 text-gray-600">
                            <li>徳島県高等教育機関連携型「ジュニアドクター発掘・養成講座」修了</li>
                            <li>第2回プログラミングスタジアム「プロスタ大賞（夏休み研究部門）」</li>
                            <li>とくしまキッズプログラミングコンテスト2022「最優秀賞」</li>
                            <li>U-16プログラミングコンテスト阿南大会 第3回阿南大会小学生競技部門「優勝 (BCN ITジュニア U-16賞 2023)」</li>
                            <li>徳島県小学生プログラミング大会2022「準グランプリ」</li>
                            <li>第2回デジタルとくしま大賞「e-とくしま推進財団賞（小学生部門賞）」</li>
                            <li>第3回デジタルとくしま大賞「e-とくしま推進財団賞（学生部門賞）」</li>
                        </ul>
                        <br>
                        <h4 class="text-xl font-bold text-gray-800 mb-4">資格</h4>
                        <ul class="list-disc list-inside space-y-2 text-gray-600">
                            <li>ITパスポート（国家資格）</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Gallery Section (5. 作品例) -->
        <section id="gallery" class="py-20 px-6 bg-gray-50">
            <div class="container mx-auto">
                <h2 class="text-4xl font-bold text-center text-gray-900 mb-12 fade-in">作品例を見てみよう</h2>
                <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 mb-12 fade-in">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4 border-b pb-2">Scratch 作品例：シューティングゲーム</h3>
                    <div class="scratch-embed-container rounded-lg overflow-hidden border-2 border-gray-200">
                        <!-- ScratchプロジェクトID: 1203211243 を埋め込み -->
                        <iframe src="https://scratch.mit.edu/projects/1203211243/embed" allowtransparency="true" width="485" height="402" frameborder="0" scrolling="no" allowfullscreen loading="lazy" onerror="this.onerror=null; this.src='https://placehold.co/485x402/eeeeee/333333?text=Scratch+Project+Loading...'">
                        </iframe>
                    </div>
                    <p class="text-center text-gray-600 mt-4 text-sm">※埋め込み作品ID: 1203211243</p>
                    <!-- text-gradientはそのままパステルグラデーションを使用 -->
                    <p class="text-center text-gray-700 mt-2 font-bold text-gradient">当日、あなたのアイデアを形にするお手伝いをします！</p>
                </div>
            </div>
        </section>

        <!-- ★★★ Voice Section (6. 参加者の声) - 新規追加 ★★★ -->
        <section id="voice" class="py-20 px-6">
            <div class="container mx-auto">
                <h2 class="text-4xl font-bold text-center text-gray-900 mb-12 fade-in">参加者の声</h2>
                <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">

                    <!-- Voice Card 1: 小学生 -->
                    <div class="bg-white rounded-xl shadow-lg card-hover transition duration-300 fade-in voice-card">
                        <div class="voice-card-content">
                            <p class="text-xl text-gray-800 italic mb-4">
                                「初めてMicro:bitを触りましたが、ゲームが作れてびっくりしました！先生が優しく教えてくれたので、難しくなかったです。」
                            </p>
                            <div class="flex items-center justify-end mt-4">
                                <i class="fas fa-child text-xl text-[#83E8D0] mr-2"></i>
                                <p class="font-semibold text-gray-700">小学5年生（男子）</p>
                            </div>
                        </div>
                    </div>

                    <!-- Voice Card 2: 保護者 -->
                    <div class="bg-white rounded-xl shadow-lg card-hover transition duration-300 fade-in voice-card" style="animation-delay: 0.1s;">
                        <div class="voice-card-content">
                            <p class="text-xl text-gray-800 italic mb-4">
                                「中学生の先生から教えてもらえるのが、子供にとってとても刺激になったようです。同世代の目線で教えてくれるので、理解が深まったと言っていました。」
                            </p>
                            <div class="flex items-center justify-end mt-4">
                                <i class="fas fa-users text-xl text-[#A5B4FC] mr-2"></i>
                                <p class="font-semibold text-gray-700">参加者の保護者</p>
                            </div>
                        </div>
                    </div>

                    <!-- Voice Card 3: 中学生 -->
                    <div class="bg-white rounded-xl shadow-lg card-hover transition duration-300 fade-in voice-card" style="animation-delay: 0.2s;">
                        <div class="voice-card-content">
                            <p class="text-xl text-gray-800 italic mb-4">
                                「Scratchは知っていましたが、今回はWebサイトの作り方を教えてもらいました。自分で作ったものがすぐに画面に出るのは感動的でした！」
                            </p>
                            <div class="flex items-center justify-end mt-4">
                                <i class="fas fa-laptop-code text-xl text-[#83E8D0] mr-2"></i>
                                <p class="font-semibold text-gray-700">中学1年生（女子）</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Voice Card 4: 初心者 -->
                    <div class="bg-white rounded-xl shadow-lg card-hover transition duration-300 fade-in voice-card" style="animation-delay: 0.3s;">
                        <div class="voice-card-content">
                            <p class="text-xl text-gray-800 italic mb-4">
                                「プログラミングの経験は全くありませんでしたが、自分のペースで進められました。また参加して次はゲームを完成させたいです。」
                            </p>
                            <div class="flex items-center justify-end mt-4">
                                <i class="fas fa-graduation-cap text-xl text-[#A5B4FC] mr-2"></i>
                                <p class="font-semibold text-gray-700">小学6年生（男子）</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>


        <!-- News Section (6. 活動記録) -->
        <section id="news" class="py-20 px-6 bg-gray-100">
            <div class="container mx-auto">
                <h2 class="text-4xl font-bold text-center text-gray-900 mb-12 fade-in">活動記録</h2>
                
                <!-- チラシ拡大モーダルボタンをNewsセクションに移動 -->
                <div class="mt-12 pt-6 border-t border-gray-200 text-center max-w-4xl mx-auto"> 
                    <h3 class="text-2xl font-bold text-gray-900 mb-6">教室のチラシはこちら！</h3>
                    <!-- 画像クリックでopenFlyerModal関数を呼び出す -->
                    <img id="flyer-image" src="中学生が教える_v3.0.png" alt="プログラミング教室のチラシ" class="w-full h-auto max-w-xl mx-auto rounded-lg shadow-2xl cursor-pointer hover:shadow-xl transition duration-300 transform hover:scale-[1.01]" onclick="openFlyerModal()">
                </div>


                <!-- 活動記録の表示エリア -->
                <div id="activity-log" class="max-w-4xl mx-auto mt-12 space-y-6">
                    <!-- JavaScriptによって活動記録がここに挿入されます -->
                </div>
            </div>
        </section>

        <!-- Footer Section -->
        <footer class="bg-gray-800 text-white py-8 px-6">
            <div class="container mx-auto text-center">
                <p class="text-sm">&copy; 2024 中学生が教えるプログラミング教室 All Rights Reserved.</p>
                <div class="flex justify-center space-x-6 mt-4">
                    <!-- 連絡先アイコンのプレースホルダー -->
                    <a href="mailto:info@example.com" class="text-gray-400 hover:text-white transition duration-300"><i class="fas fa-envelope text-xl"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300"><i class="fas fa-hashtag text-xl"></i></a> <!-- SNSハッシュタグのイメージ -->
                </div>
            </div>
        </footer>
    </main>

    <!-- メッセージボックス (Alert代替) -->
    <div id="message-box" class="message-box bg-red-500 text-white"></div>
    
    <!-- ★★★ チラシ拡大モーダル (Flyer Modal) - Newsセクションの外側に配置 ★★★ -->
    <div id="flyer-modal-overlay" class="flyer-modal-overlay" onclick="closeFlyerModal()">
        <div class="flyer-modal-content" onclick="event.stopPropagation()">
            <img src="中学生が教える_v3.0.png" alt="拡大されたプログラミング教室のチラシ">
        </div>
    </div>

    <!-- ★★★ トップに戻るボタン ★★★ -->
    <button id="to-top-button" class="shadow-lg" onclick="window.scrollToTop()" aria-label="トップに戻る">
        <i class="fas fa-arrow-up"></i>
    </button>
    

    <!-- FirestoreとFirebase Authのインポート -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        // 修正: getDocs をインポートリストに追加
        import { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, orderBy, limit, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Firestoreのログレベルを設定 (デバッグ用)
        setLogLevel('Debug');
        
        // グローバル変数からFirebase設定を取得
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let app, db, auth, userId = null;
        let isAuthReady = false;
        
        // 認証状態の準備が完了するのを待つPromise
        const authReadyPromise = new Promise(resolve => {
            if (Object.keys(firebaseConfig).length > 0) {
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        console.log("Firebase Auth State Changed: Signed in. User ID:", userId);
                    } else {
                        // 匿名サインインを試みる（またはトークンがない場合のフォールバック）
                        if (initialAuthToken) {
                             // カスタムトークンでサインイン
                            try {
                                await signInWithCustomToken(auth, initialAuthToken);
                                userId = auth.currentUser.uid;
                                console.log("Firebase Auth: Signed in with custom token. User ID:", userId);
                            } catch (error) {
                                console.error("Error signing in with custom token:", error);
                                // エラー時は匿名サインインにフォールバック
                                await signInAnonymously(auth);
                                userId = auth.currentUser.uid;
                                console.log("Firebase Auth: Fallback to anonymous sign in. User ID:", userId);
                            }
                        } else {
                            // トークンがない場合は匿名サインイン
                            await signInAnonymously(auth);
                            userId = auth.currentUser.uid;
                            console.log("Firebase Auth: Signed in anonymously. User ID:", userId);
                        }
                    }
                    isAuthReady = true;
                    resolve();
                });
            } else {
                // Firebase Configがない場合は匿名ユーザーとして続行
                isAuthReady = true;
                userId = crypto.randomUUID(); // Fallback user ID
                console.warn("Firebase config is missing. Using local fallback for userId.");
                resolve();
            }
        });

        
        /**
         * メッセージボックスを表示する関数 (Alert代替)
         * @param {string} message - 表示するメッセージ
         * @param {string} type - 'success' または 'error'
         */
        window.showMessage = function(message, type = 'success') {
            const box = document.getElementById('message-box');
            box.textContent = message;
            box.className = 'message-box show'; // 基本クラスをリセットしてからshowを追加

            if (type === 'error') {
                box.classList.add('bg-red-500');
            } else {
                box.classList.add('bg-green-500');
            }

            setTimeout(() => {
                box.classList.remove('show');
                // 300msのアニメーション後に背景色クラスを削除
                setTimeout(() => {
                    box.classList.remove('bg-red-500', 'bg-green-500');
                }, 300);
            }, 3000);
        };

        // アクティビティログのデータを定義 (ダミーデータ)
        const activityData = [
            { id: '1', date: '2024.10.05', title: '第5回プログラミング教室を開催しました！', content: '今回のテーマは「Micro:bitで音楽を作ろう」でした。参加した子供たちは、Scratchでブロックを組み合わせて音階を学び、Micro:bitのスピーカーからオリジナルの曲を流すことに挑戦しました。特に、センサーを使って音量を変える工夫をしている子が多かったです。みんな真剣に取り組んでいました！' },
            { id: '2', date: '2024.09.28', title: 'Webサイト開発に挑戦！', content: '上級者向けのコースでは、HTMLとCSSの基礎を教え、自分だけのポートフォリオサイトの作成に取り組みました。最初は難しそうにしていた子も、色や配置が変わる楽しさを知り、熱心にコードを書いていました。次回の目標はJavaScriptを使った動きのあるサイトです。' },
            { id: '3', date: '2024.09.14', title: '初心者向けScratchゲーム作り', content: 'プログラミングが初めてという小学生を中心に、Scratchで簡単なシューティングゲームを作りました。猫のキャラクターを動かし、敵を倒す仕組みを学びました。子供たちの発想力は豊かで、オリジナルの敵キャラやアイテムを追加するアイデアがたくさん出てきました！' },
        ];


        /**
         * 活動記録のデータをレンダリングする関数
         */
        window.renderActivityLog = async function() {
            // Firebase Authの準備を待つ
            await authReadyPromise;

            const container = document.getElementById('activity-log');
            if (!container) return;
            
            // Firestoreからデータを取得する場合のパス (ニュースはパブリックデータとする)
            const collectionPath = `/artifacts/${appId}/public/data/news`;
            
            // 最初にローディングメッセージを表示
            container.innerHTML = `<div class="text-center text-gray-500 py-10">活動記録を読み込み中...</div>`;

            let hasData = false;
            
            if (db) {
                try {
                    // Firestoreから最新の活動記録を3件取得 (日付降順)
                    // 注: orderByを一旦削除し、クライアント側でソートすることでインデックス不要のエラーを回避
                    const q = query(collection(db, collectionPath), limit(5));
                    
                    // リアルタイムリスナーを設定
                    onSnapshot(q, (snapshot) => {
                        const activities = [];
                        snapshot.forEach(doc => {
                            const data = doc.data();
                            activities.push({ id: doc.id, ...data });
                        });

                        // 日付の降順でソート (クライアント側ソート)
                        activities.sort((a, b) => new Date(b.date) - new Date(a.date));

                        if (activities.length > 0) {
                            hasData = true;
                            container.innerHTML = activities.map(activity => `
                                <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition duration-300 cursor-pointer card-hover fade-in" 
                                     onclick="openActivityDetail('${activity.id}', '${activity.title}', '${activity.date}', \`${activity.content.replace(/`/g, '\\`')}\')">
                                    <p class="text-sm text-gray-500 mb-1">${activity.date}</p>
                                    <h3 class="text-xl font-bold text-gray-900">${activity.title}</h3>
                                    <p class="text-gray-600 mt-2 line-clamp-2">${activity.content}</p>
                                    <span class="text-sm text-[#83E8D0] font-semibold mt-2 inline-block">詳細を見る <i class="fas fa-arrow-right text-xs"></i></span>
                                </div>
                            `).join('');
                        } else if (!hasData) {
                            // データがない場合、ダミーデータを一度だけ書き込む
                            container.innerHTML = `<div class="text-center text-gray-500 py-10">データがありません。ダミーデータを初期化中...</div>`;
                            initializeDummyData(collectionPath);
                        }
                    }, (error) => {
                        console.error("Error setting up onSnapshot listener:", error);
                        container.innerHTML = `<div class="text-center text-red-500 py-10">活動記録の読み込みエラーが発生しました。</div>`;
                    });

                } catch (e) {
                    console.error("Error accessing Firestore:", e);
                    container.innerHTML = `<div class="text-center text-red-500 py-10">データベース接続エラー: ${e.message}</div>`;
                }
            } else {
                // Firebase Configがない場合のフォールバック（ダミーデータ表示）
                 container.innerHTML = activityData.map(activity => `
                    <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition duration-300 cursor-pointer card-hover fade-in" 
                         onclick="openActivityDetail('${activity.id}', '${activity.title}', '${activity.date}', \`${activity.content.replace(/`/g, '\\`')}\')">
                        <p class="text-sm text-gray-500 mb-1">${activity.date}</p>
                        <h3 class="text-xl font-bold text-gray-900">${activity.title}</h3>
                        <p class="text-gray-600 mt-2 line-clamp-2">${activity.content}</p>
                        <span class="text-sm text-[#83E8D0] font-semibold mt-2 inline-block">詳細を見る <i class="fas fa-arrow-right text-xs"></i></span>
                    </div>
                `).join('');
                console.warn("Using dummy data for activity log as Firebase is not fully configured or initialized.");
            }
        };

        /**
         * ダミーデータをFirestoreに初期化する関数
         */
        async function initializeDummyData(collectionPath) {
            if (!db) return;
            const newsCollection = collection(db, collectionPath);
            try {
                // 既存のドキュメントをチェック
                // 修正: getDocs が import されているため、この行でエラーは解消
                const snapshot = await getDocs(newsCollection); 
                if (snapshot.empty) {
                    console.log("Initializing dummy data...");
                    for (const item of activityData) {
                        // ドキュメントIDをFirestoreに任せるため、IDを除外して追加
                        const { id, ...data } = item;
                        await addDoc(newsCollection, data);
                    }
                    console.log("Dummy data initialized successfully.");
                } else {
                    console.log("Dummy data already exists. Skipping initialization.");
                }
            } catch (error) {
                console.error("Error initializing dummy data:", error);
            }
        }
        
        /**
         * 詳細ビューを開く関数
         * @param {string} id - 記事ID
         * @param {string} title - 記事タイトル
         * @param {string} date - 日付
         * @param {string} content - 記事本文
         */
        window.openActivityDetail = function(id, title, date, content) {
            const detailView = document.getElementById('activity-detail-view');
            const detailTitle = document.getElementById('detail-title');
            const detailDate = document.getElementById('detail-date');
            const detailContent = document.getElementById('detail-content');

            // HTMLエンコードされた特殊文字を元に戻す
            const decodedTitle = title.replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '"');
            
            // 詳細コンテンツをセット
            detailTitle.textContent = decodedTitle;
            detailDate.textContent = date;
            
            // Markdown風の簡易フォーマットを適用
            let formattedContent = content.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); // **太字**
            formattedContent = formattedContent.replace(/\n/g, '<br>'); // 改行
            
            detailContent.innerHTML = formattedContent;

            // スライドインアニメーションを開始
            detailView.classList.remove('slide-hidden');
            detailView.classList.add('slide-visible');

            // 詳細ビューの上部にスクロール
            detailView.scrollTop = 0;
            
            // URLハッシュを変更
            window.location.hash = `news-detail-${id}`;
        };

        /**
         * 詳細ビューを閉じる関数
         */
        window.closeActivityDetail = function() {
            const detailView = document.getElementById('activity-detail-view');
            // スライドアウトアニメーションを開始
            detailView.classList.remove('slide-visible');
            detailView.classList.add('slide-hidden');
            
            // URLハッシュをクリア
            if (window.location.hash.startsWith('#news-detail-')) {
                history.replaceState(null, '', ' '); // URLからハッシュを削除
            }
        };
        
        /**
         * チラシ拡大モーダルを開く関数
         */
        window.openFlyerModal = function() {
            const modal = document.getElementById('flyer-modal-overlay');
            modal.classList.add('open');
            document.body.style.overflow = 'hidden'; // 背景スクロールを禁止
        }

        /**
         * チラシ拡大モーダルを閉じる関数
         */
        window.closeFlyerModal = function() {
            const modal = document.getElementById('flyer-modal-overlay');
            modal.classList.remove('open');
            document.body.style.overflow = ''; // 背景スクロールを許可
        }

    </script>
    
    <!-- ★★★ 活動記録詳細ビュー (Activity Detail View) - Mainの外側に配置 ★★★ -->
    <div id="activity-detail-view" class="slide-hidden">
        <div class="detail-content-wrapper bg-white min-h-full rounded-xl shadow-2xl p-6 sm:p-10">
            <!-- 戻るボタン -->
            <button onclick="closeActivityDetail()" class="text-gray-600 hover:text-gray-900 transition duration-300 mb-6 flex items-center">
                <i class="fas fa-arrow-left mr-2"></i> <span>メインページに戻る</span>
            </button>
            
            <!-- 詳細コンテンツ -->
            <article class="article-content">
                <p id="detail-date" class="text-sm text-gray-500 mb-2"></p>
                <h1 id="detail-title" class="text-4xl font-extrabold text-gray-900 mb-6 border-b pb-4"></h1>
                <div id="detail-content" class="text-lg text-gray-700 leading-relaxed space-y-4">
                    <!-- 記事本文がここに挿入されます -->
                </div>
            </article>

            <!-- 閉じるボタン (下部にも配置) -->
            <div class="mt-12 pt-6 border-t border-gray-200 text-center">
                <button onclick="closeActivityDetail()" class="bg-[#A5B4FC] hover:bg-[#83E8D0] text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300">
                    メインページに戻る
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // ★★★ トップに戻るボタンの機能 ★★★
        const toTopButton = document.getElementById('to-top-button');

        window.addEventListener('scroll', () => {
            // スクロール量が500pxを超えたらボタンを表示
            if (document.body.scrollTop > 500 || document.documentElement.scrollTop > 500) {
                toTopButton.classList.add('show');
            } else {
                toTopButton.classList.remove('show');
            }
        });
        
        // トップにスクロールする関数
        window.scrollToTop = function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        };
        // ★★★ トップに戻るボタンの機能 ここまで ★★★


        document.addEventListener('DOMContentLoaded', () => {
            const menuButton = document.getElementById('menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            const barsIcon = document.getElementById('bars-icon');
            const timesIcon = document.getElementById('times-icon');

            // 活動記録をレンダリング
            renderActivityLog();
            
            // Mobile menu toggle
            menuButton.addEventListener('click', function() {
                mobileMenu.classList.toggle('menu-open');
                barsIcon.classList.toggle('hidden');
                timesIcon.classList.toggle('hidden');
            });

            // Close menu when a link is clicked
            document.querySelectorAll('#mobile-menu a').forEach(link => {
                link.addEventListener('click', function() {
                    // スムーズスクロール完了後にメニューを閉じるようにする
                    setTimeout(() => {
                        mobileMenu.classList.remove('menu-open');
                        barsIcon.classList.remove('hidden');
                        timesIcon.classList.add('hidden');
                    }, 500); 
                });
            });
        });
    </script>
</body>
</html>
